# ===============================================================
# Surge 配置文件模板 (入门版)
# 创建时间: 2025-08-14
# 原则: 安全、稳定、易于理解
# ===============================================================

[General]
# --- 基础设置 ---
# 日志级别 (建议: notify)
loglevel = notify
# 跳过代理
skip-proxy = 127.0.0.1, 192.168.0.0/16, 10.0.0.0/8, 172.16.0.0/12, localhost, *.local
# 允许 Wi-Fi 访问
wifi-access-http = 0.0.0.0:6152
wifi-access-socks5 = 0.0.0.0:6153
# IPv6 支持 (如果您的网络不支持IPv6，可以设为 false)
ipv6 = true

# --- DNS 设置 ---
# 使用公共 DNS，可以有效防止 DNS 污染，同时支持加密 DNS
doh-server = https://sm2.doh.pub/dns-query, https://doh.pub/dns-query,    # 国内 DNSPod & AliDNS
dot-server = dot.pub

# ===============================================================

[Proxy]
# --- 代理服务器 ---
# 在这里粘贴您的代理节点信息。
# 格式: 节点名称 = 协议, 服务器地址, 端口, ...
# 示例: 节点1 = trojan, example.com, 443, password=your_password, sni=example.com
#
# !!! 强烈建议使用“外部代理列表(Proxy Provider)”功能来托管您的节点 !!!
# 这样可以让主配置文件保持干净，并且可以单独更新节点。
# 格式: 外部节点 = provider, "订阅链接", update-interval=3600
#
# !!! 请将下面的示例链接替换为您自己的机场订阅链接 !!!
节点订阅 = provider, "再次粘贴自己的机场订阅链接", update-interval=3600

# ===============================================================

[Proxy Group]
# --- 策略组 ---
# 策略组是 Surge 的精髓，它决定了网络请求的走向。

# 1. 节点选择 (手动选择)
# 这是最核心的代理组，包含了您所有的节点。
节点选择 = select, provider=节点订阅, hidden=false

# 2. 自动选择 (URL 测速)
# 自动选择延迟最低的节点，适合不爱折腾的用户。
自动选择 = url-test, provider=节点订阅, url = http://www.gstatic.com/generate_204, interval = 300, tolerance=50

# 3. 国外网站 (最终决策)
# 这个组决定了访问国外网站时使用哪个策略。
国外网站 = select, 节点选择, 自动选择

# 4. 国内网站
# 所有国内流量都从这里走，直接连接，不走代理。
国内网站 = select, DIRECT

# 5. 广告拦截
# 所有广告流量都从这里走，直接拒绝连接。
广告拦截 = select, REJECT

# 6. 苹果服务
# 苹果的各种服务（App Store, iCloud等）有时直连更快，有时代理更快。
# 这里也设置为直连，如果遇到 App Store 打不开等问题，可以改为“节点选择”。
苹果服务 = select, DIRECT, 节点选择

# ===============================================================

[Rule]
# --- 分流规则 ---
# 规则按从上到下的顺序匹配，一旦匹配成功，就不再继续往下。
# 规则集(Rule-Set)是别人整理好的一系列域名/IP列表，我们直接引用即可。
# 我们这里只使用知名社区维护的 Lighthouse (ConnersHua) 规则集，安全可靠。

# 1. 广告拦截规则
RULE-SET,https://raw.githubusercontent.com/ConnersHua/Profiles/master/Surge/Ruleset/Advertising.list,广告拦截

# 2. 国内网站规则
RULE-SET,https://raw.githubusercontent.com/ConnersHua/Profiles/master/Surge/Ruleset/China.list,国内网站

# 3. 苹果服务规则
RULE-SET,https://raw.githubusercontent.com/ConnersHua/Profiles/master/Surge/Ruleset/Apple.list,苹果服务

# 4. 局域网规则
IP-CIDR,192.168.0.0/16,DIRECT
IP-CIDR,10.0.0.0/8,DIRECT
IP-CIDR,172.16.0.0/12,DIRECT
IP-CIDR,127.0.0.1/8,DIRECT

# 5. 最终规则 (兜底规则)
# FINAL 规则是最后一道防线，所有上面没有匹配到的流量，都会走到这里。
# 我们让所有未匹配的流量都走“国外网站”策略组。
FINAL,国外网站
